(window.webpackJsonp=window.webpackJsonp||[]).push([[228],{744:function(n,e,t){"use strict";t.r(e),e.default="/* globals Proton,_ */\nconst {Scene, Sprite, Arc, ProtonRenderer} = spritejs;\nconst container = document.getElementById('page');\n\nconst scene = new Scene({\n  container,\n  displayRatio: 2,\n});\nconst layer = scene.layer('bglayer', {\n  handleEvent: true,\n  autoRender: false,\n});\n\nconst fglayer = scene.layer('fglayer', {\n  handleEvent: false,\n  autoRender: false,\n  contextType: '2d',\n});\n\nscene.addEventListener('resize', _.debounce((evt) => {\n  main();\n}, 300));\n\nconst logo = new Sprite('https://p0.ssl.qhimg.com/t01a72262146b87165f.png');\nlogo.attr({\n  pos: [10, 10],\n  scale: 0.5,\n});\nfglayer.append(logo);\n\n\nconst proton = new Proton();\nconst R = 280;\nlet pointZone,\n  emitter;\n\nmain();\ntick();\n\nfunction main() {\n  layer.removeAllChildren();\n  layer.removeAllListeners('mousedown');\n  layer.removeAllListeners('mouseup');\n  layer.removeAllListeners('mousemove');\n  const {width} = layer;\n  const num = Math.min(parseInt(0.5 * width / (1000 / 145), 10), 300);\n  createProton(proton, num);\n  setTimeout(addMouseEvent, 200);\n  addRenderer();\n}\n\nfunction createProton(proton, num) {\n  proton.destroy();\n  emitter = new Proton.Emitter();\n  emitter.rate = new Proton.Rate(new Proton.Span(num), new Proton.Span(0.1, 0.4));\n\n  emitter.addInitialize(new Proton.Mass(1));\n  // emitter.addInitialize(new Proton.Radius(3, 7));\n  const circle = new Arc({radius: 5});\n  emitter.addInitialize(new Proton.Body(circle));\n  emitter.addInitialize(new Proton.Life(Infinity));\n\n  const {width, height} = layer;\n  pointZone = new Proton.Position(new Proton.RectZone(0, 0, width, height));\n\n  emitter.addInitialize(pointZone);\n  emitter.addInitialize(new Proton.Velocity(new Proton.Span(1.2, 2.0), new Proton.Span(0, 360), 'polar'));\n\n  emitter.addBehaviour(new Proton.Alpha(Proton.getSpan(0.2, 0.9)));\n  emitter.addBehaviour(new Proton.Scale(Proton.getSpan(0.2, 1.0)));\n  emitter.addBehaviour(new Proton.Color('#ffffff'));\n  emitter.addBehaviour(new Proton.CrossZone(new Proton.RectZone(0, 0, width, height), 'cross'));\n\n  emitter.emit('once');\n  emitter.damping = 0;\n  proton.addEmitter(emitter);\n\n  return proton;\n}\n\nfunction addRenderer() {\n  const renderer = new ProtonRenderer(layer);\n  renderer.onProtonUpdateAfter = function () {\n    fglayer.render();\n    const context = fglayer.renderer.canvasRenderer.context;\n    context.save();\n    // context.scale(fglayer.displayRatio, fglayer.displayRatio);\n    const particles = this.parent.emitters[0].particles;\n\n    for(let i = 0; i < particles.length; i++) {\n      for(let j = i + 1; j < particles.length; j++) {\n        const pA = particles[i];\n        const pB = particles[j];\n        const dis = pA.p.distanceTo(pB.p);\n\n        if(dis < R) {\n          const alpha = (1 - dis / R) * 0.5;\n          context.strokeStyle = `rgba(255,255,255,${alpha})`;\n          context.beginPath();\n          context.lineWidth = 2;\n          context.moveTo(pA.p.x * 2, pA.p.y * 2);\n          context.lineTo(pB.p.x * 2, pB.p.y * 2);\n          context.closePath();\n          context.stroke();\n        }\n      }\n    }\n    context.restore();\n  };\n\n  proton.addRenderer(renderer);\n}\n\nfunction addMouseEvent() {\n  emitter.rate = new Proton.Rate(new Proton.Span(3), 0.5);\n  emitter.removeInitialize(pointZone);\n\n  layer.addEventListener('mousedown', (e) => {\n    for(let i = 0; i < 3; i++) {\n      emitter.particles[i].dead = true;\n    }\n\n    setTimeout(() => {\n      emitter.p.x = e.x;\n      emitter.p.y = e.y;\n      emitter.emit('once');\n    }, 60);\n  });\n\n  layer.addEventListener('mouseup', (e) => {\n    emitter.stop();\n  });\n\n  layer.addEventListener('mousemove', (e) => {\n    const p0 = emitter.particles[0];\n    p0.radius = 0;\n\n    const ease = 0.3;\n\n    p0.p.x += (e.x - p0.p.x) * ease;\n    p0.p.y += (e.y - p0.p.y) * ease;\n  });\n}\n\nfunction tick() {\n  requestAnimationFrame(tick);\n  proton.update();\n  proton.stats.update(3);\n}"}}]);